{"version":3,"sources":["../../src/cronjob/okra-query.js"],"names":["fetch","require","makeOkraQuery","Object","freeze","balanceRefresh","balanceCallback","payInitiate","account_id","console","log","body","method","headers","Accept","Authorization","JSON","stringify","then","res","json","callback_url","nPay"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,KAAK,GAAGC,OAAO,CAAC,YAAD,CAArB;;AAEe,SAASC,aAAT,GAAwB;AACnC,SAAOC,MAAM,CAACC,MAAP,CAAc;AACnBC,IAAAA,cADmB;AAEnBC,IAAAA,eAFmB;AAGnBC,IAAAA;AAHmB,GAAd,CAAP;;AAMA,iBAAeF,cAAf,CAA+B;AAAEG,IAAAA;AAAF,MAAiB,EAAhD,EAAoD;AAClDC,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAoBF,UAAhC;AAGA,UAAMG,IAAI,GAAG;AACXH,MAAAA,UAAU,EAAGA;AADF,KAAb;AAKA;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGM,WAAOR,KAAK,CAAC,wCAAD,EAA2C;AACrDY,MAAAA,MAAM,EAAE,MAD6C;AAErDC,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE,iCADD;AAEPC,QAAAA,aAAa,EAAE,8JAFR;AAGP,wBAAgB;AAHT,OAF4C;AAOrDJ,MAAAA,IAAI,EAAEK,IAAI,CAACC,SAAL,CAAeN,IAAf;AAP+C,KAA3C,CAAL,CASNO,IATM,CASDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EATN,EAUNF,IAVM,CAUDE,IAAI,IAAI;AACZX,MAAAA,OAAO,CAACC,GAAR,CAAYU,IAAZ;AACA,aAAOA,IAAP;AACD,KAbM,CAAP;AAmBD;;AAED,iBAAed,eAAf,CAA+B;AAAEe,IAAAA;AAAF,MAAmB,EAAlD,EAAsD;AAEpD,WAAOrB,KAAK,CAACqB,YAAD,EAAe;AACzBT,MAAAA,MAAM,EAAE,MADiB;AAEzBC,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE,iCADD;AAEPC,QAAAA,aAAa,EAAE,8JAFR;AAGP,wBAAgB;AAHT;AAFgB,KAAf,CAAL,CAQNG,IARM,CAQDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EARN,EASNF,IATM,CASDE,IAAI,IAAI;AACZ,aAAOA,IAAP;AACD,KAXM,CAAP;AAaD;;AAED,iBAAeb,WAAf,CAA2B;AAAEe,IAAAA;AAAF,MAAW,EAAtC,EAA0C;AAExC,WAAOtB,KAAK,CAAC,qCAAD,EAAwC;AAClDY,MAAAA,MAAM,EAAE,MAD0C;AAElDC,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE,iCADD;AAEPC,QAAAA,aAAa,EAAE,8JAFR;AAGP,wBAAgB;AAHT,OAFyC;AAOlDJ,MAAAA,IAAI,EAAEK,IAAI,CAACC,SAAL,CAAeK,IAAf;AAP4C,KAAxC,CAAL,CASNJ,IATM,CASDC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EATN,EAUNF,IAVM,CAUDE,IAAI,IAAI;AACZ,aAAOA,IAAP;AACD,KAZM,CAAP;AAcD;AAGJ","sourcesContent":["import { UniqueConstraintError } from '../helpers/errors'\nimport Okra from 'okra-js';\n\nconst fetch = require('node-fetch');\n\nexport default function makeOkraQuery(){\n    return Object.freeze({\n      balanceRefresh,\n      balanceCallback,\n      payInitiate\n    });\n\n    async function balanceRefresh ({ account_id } = {}) {\n      console.log(\"account id query \"+account_id);\n      \n\n      const body = {\n        account_id : account_id\n      \n      };\n\n      /*let response = await fetch('https://api.okra.ng/v2/products/complete-view/process', {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json; charset=utf-8',\n          Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDc2ZWU3Mjc4ZGUwZjExZDVkMWJlMGIiLCJpYXQiOjE2MTg0MDcwMjd9.Q-R0qocVPKnCZHtpGigsTtoN-MVlUIhZ9LsSrW7VCsM',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      })\n\n      return await response;*/\n\n      return fetch('https://api.okra.ng/v2/balance/refresh', {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json; charset=utf-8',\n          Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDc2ZWU3Mjc4ZGUwZjExZDVkMWJlMGIiLCJpYXQiOjE2MTg0MDcwMjd9.Q-R0qocVPKnCZHtpGigsTtoN-MVlUIhZ9LsSrW7VCsM',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      })\n      .then(res => res.json())\n      .then(json => {\n        console.log(json)\n        return json;\n      });\n    \n      \n\n      \n      \n    }\n\n    async function balanceCallback({ callback_url } = {}) {\n        \n      return fetch(callback_url, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json; charset=utf-8',\n          Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDc2ZWU3Mjc4ZGUwZjExZDVkMWJlMGIiLCJpYXQiOjE2MTg0MDcwMjd9.Q-R0qocVPKnCZHtpGigsTtoN-MVlUIhZ9LsSrW7VCsM',\n          'Content-Type': 'application/json'\n        }\n      })\n      .then(res => res.json())\n      .then(json => {\n        return json;\n      });\n\n    }\n\n    async function payInitiate({ nPay } = {}) {\n\n      return fetch('https://api.okra.ng/v2/pay/initiate', {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json; charset=utf-8',\n          Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDc2ZWU3Mjc4ZGUwZjExZDVkMWJlMGIiLCJpYXQiOjE2MTg0MDcwMjd9.Q-R0qocVPKnCZHtpGigsTtoN-MVlUIhZ9LsSrW7VCsM',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(nPay)\n      })\n      .then(res => res.json())\n      .then(json => {\n        return json;\n      });\n    \n    }\n\n\n}\n\n"],"file":"okra-query.js"}