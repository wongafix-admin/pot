{"version":3,"sources":["../../src/mailer/index.js"],"names":["nodemailer","require","sendEmail","httpRequest","msgInfo","body","statusCode","errorMessage","JSON","parse","transporter","createTransport","service","auth","user","pass","template","message","sendMail","from","to","email","subject","topic","text","html","then","info","console","log","status","catch","error"],"mappings":";;;;;;;AAAA;;;;AAEA,MAAMA,UAAU,GAAGC,OAAO,CAAC,YAAD,CAA1B;;AAEe,SAASC,SAAT,CAAoBC,WAApB,EAAiC;AAC5C,MAAIC,OAAO,GAAGD,WAAW,CAACE,IAA1B;;AAEA,MAAI,CAACD,OAAL,EAAc;AACV,WAAO,wBAAc;AACrBE,MAAAA,UAAU,EAAE,GADS;AAErBC,MAAAA,YAAY,EAAE;AAFO,KAAd,CAAP;AAIH;;AAED,MAAI,OAAOJ,WAAW,CAACE,IAAnB,KAA4B,QAAhC,EAA0C;AACtC,QAAI;AACAD,MAAAA,OAAO,GAAGI,IAAI,CAACC,KAAL,CAAWL,OAAX,CAAV;AACH,KAFD,CAEE,MAAM;AACR,aAAO,wBAAc;AACjBE,QAAAA,UAAU,EAAE,GADK;AAEjBC,QAAAA,YAAY,EAAE;AAFG,OAAd,CAAP;AAIC;AACJ;;AAGD,QAAMG,WAAW,GAAGV,UAAU,CAACW,eAAX,CAA2B;AAC3CC,IAAAA,OAAO,EAAE,OADkC;AAE3CC,IAAAA,IAAI,EAAE;AACJC,MAAAA,IAAI,EAAE,wBADF;AAEJC,MAAAA,IAAI,EAAE;AAFF;AAFqC,GAA3B,CAApB;AASA,QAAMC,QAAQ,GAAI;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oHAvCqB,GAuCgGZ,OAAO,CAACa,OAvCxG,GAuCiH;AACtI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YApEI;AAuEAP,EAAAA,WAAW,CAACQ,QAAZ,CAAqB;AACjBC,IAAAA,IAAI,EAAE,qCADW;AAC4B;AAC7CC,IAAAA,EAAE,EAAEhB,OAAO,CAACiB,KAFK;AAEE;AACnBC,IAAAA,OAAO,EAAElB,OAAO,CAACmB,KAHA;AAGO;AACxBC,IAAAA,IAAI,EAAEpB,OAAO,CAACa,OAJG;AAIM;AACvBQ,IAAAA,IAAI,EAAET,QALW,CAKD;;AALC,GAArB,EAMOU,IANP,CAMYC,IAAI,IAAI;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACA,WAAO;AACHG,MAAAA,MAAM,EAAE,SADL;AAEHb,MAAAA,OAAO,EAAEU;AAFN,KAAP;AAIH,GAZL,EAYOI,KAZP,CAYaC,KAAK,IAAI;AACd,WAAO;AACHF,MAAAA,MAAM,EAAE,OADL;AAEHb,MAAAA,OAAO,EAAEe;AAFN,KAAP;AAIH,GAjBL;AAmBH","sourcesContent":["import makeHttpError from '../helpers/http-error';\n\nconst nodemailer = require('nodemailer');\n\nexport default function sendEmail (httpRequest) {\n    let msgInfo = httpRequest.body\n    \n    if (!msgInfo) {\n        return makeHttpError({\n        statusCode: 400,\n        errorMessage: 'Bad request. No POST body.'\n        })\n    }\n\n    if (typeof httpRequest.body === 'string') {\n        try {\n            msgInfo = JSON.parse(msgInfo)\n        } catch {\n        return makeHttpError({\n            statusCode: 400,\n            errorMessage: 'Bad request. POST body must be valid JSON.'\n        })\n        }\n    }\n\n\n    const transporter = nodemailer.createTransport({\n        service: 'gmail',\n        auth: {\n          user: 'wongafixmail@gmail.com',\n          pass: '!321Wongafix_Admin',\n        },\n    });\n    \n\n    const template = `<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n    <html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en-GB\">\n    <head>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n        <title>Wonder Double Season Greetings</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n    \n        <style type=\"text/css\">\n            @media screen {\n              @font-face {\n                font-family: 'Lato';\n                font-style: normal;\n                font-weight: 400;\n                src: local('Lato Regular'), local('Lato-Regular'), url(https://fonts.gstatic.com/s/lato/v11/qIIYRU-oROkIk8vfvxw6QvesZW2xOQ-xsNqO47m55DA.woff) format('woff');\n              }\n            \n              body {\n                font-family: \"Lato\", \"Lucida Grande\", \"Lucida Sans Unicode\", Tahoma, Sans-Serif;\n              }\n            }\n        </style>\n    </head>\n    <body style=\"margin: 0; padding: 0;\">\n        <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n            <tr>\n                <td>\n                    <table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\" style=\"border-collapse: collapse; border: 1px solid #cccccc;\">\n                        <tr>\n                            <td bgcolor=\"#edebea\" align=\"center\"  style=\"padding: 30px 10px;\">\n                                <img src=\"https://wongafix-assets.s3.eu-west-1.amazonaws.com/email/small-logo.png\" alt=\"WonderDouble banner\" width=\"150\" title=\"\" style=\"display: block;\" />\n                                \n                            </td>\n                        </tr>\n                        <tr>\n                            <td bgcolor=\"#fff\" style=\"padding: 100px 30px;\">\n                                \n                                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"border-collapse: collapse; color:#444\">\n                                    <tr>\n                                        <td style=\"padding: 0;\">\n                                            <p style=\"margin: 0; font-family: Arial, sans-serif; text-align:left;\">`+msgInfo.message+`</h2>\n                                        </td>\n                                    </tr>\n                                </table>    \n                            </td>\n                        </tr>\n                        <tr>\n                            <td align=\"center\" bgcolor=\"#2fad51\" style=\"padding: 10px 0; color:#ffffff;\">\n                                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"  style=\"border-collapse: collapse;\">\n                                    <tr>\n                                        <td align=\"center\" valign=\"top\">\n                                            <p>ADDRESS<br>Suite 13, Unique Shopping Mall, <br>Works Road, <br>GRA Ikeja, Lagos.<br><br><span style=\"font-size:14px;\">+234-905-815-4095<br> info@wongafix.com</span>\n                                            </p>\n                                        </td> \n                                    </tr>\n                                </table>\n                                \n                            </td>\n                        </tr>\n                        <tr>\n                            <td align=\"center\" bgcolor=\"#edebea\">\n                               <p style=\"color:#343c64; font-size:14px;\">&copy Wongafix 2021</p>\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n        </table>\n    </body>\n    </html>`;\n\n\n    transporter.sendMail({\n        from: '\"Wongafix\" <wongafixmail@gmail.com>', // sender address\n        to: msgInfo.email, // list of receivers\n        subject: msgInfo.topic, // Subject line\n        text: msgInfo.message, // plain text body\n        html: template, // html body\n        }).then(info => {\n            console.log(info);\n            return {\n                status: \"success\",\n                message: info\n            }\n        }).catch(error => {\n            return {\n                status: \"error\",\n                message: error\n            }\n        });\n        \n}"],"file":"index.js"}